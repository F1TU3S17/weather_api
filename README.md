# üå§Ô∏è Weather Service API

[![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=for-the-badge&logo=fastapi)](https://fastapi.tiangolo.com/)
[![Python](https://img.shields.io/badge/python-3.11+-blue?style=for-the-badge&logo=python&logoColor=white)](https://python.org)
[![Redis](https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white)](https://redis.io/)
[![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)](https://docker.com/)

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –ø–æ–≥–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò. –ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ FastAPI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å OpenWeatherMap API –∏ OpenRouter AI.

API –¥–æ—Å—Ç—É–ø–µ–Ω - https://weather-api-9ie8.onrender.com/

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üèôÔ∏è **–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤** - –ù–∞–π–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª—é–±–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –º–∏—Ä–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- üå°Ô∏è **–ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥–µ: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, –≤–µ—Ç–µ—Ä –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ
- ü§ñ **–ò–ò —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –æ–¥–µ–∂–¥–µ, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º –∏ –∑–¥–æ—Ä–æ–≤—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- ‚ö° **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–º—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö
- üê≥ **Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Docker –∏ Docker Compose
- üìö **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - Swagger UI –∏ ReDoc –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å FastAPI

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Framework**: FastAPI 0.116.1
- **Language**: Python 3.11+
- **Cache**: Redis 6.2.0
- **HTTP Client**: httpx 0.28.1
- **Validation**: Pydantic 2.11.7
- **ASGI Server**: Uvicorn 0.35.0
- **Containerization**: Docker & Docker Compose

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11 –∏–ª–∏ –≤—ã—à–µ
- Redis (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose)
- API –∫–ª—é—á –æ—Ç [OpenWeatherMap](https://openweathermap.org/api)
- API –∫–ª—é—á –æ—Ç [OpenRouter](https://openrouter.ai/) –¥–ª—è –ò–ò —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–ø–æ—Å–æ–± 1: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   git clone url
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ API –∫–ª—é—á–∏
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å Docker Compose**
   ```bash
   docker-compose up -d
   ```

4. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä**
   - API: http://localhost:8000
   - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs
   - ReDoc: http://localhost:8000/redoc

### –°–ø–æ—Å–æ–± 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   git clone https://github.com/F1TU3S17/weather_api.git
   cd weather_api
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
   ```bash
   python -m venv venv
   
   # Windows
   venv\Scripts\activate
   
   # Linux/macOS
   source venv/bin/activate
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   ```bash
   pip install -r requirements.txt
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Redis** (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker)
   ```bash
   redis-server
   ```

6. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   ```bash
   python main.py
   # –∏–ª–∏
   uvicorn main:app --reload
   ```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```env
# OpenWeatherMap API –∫–ª—é—á
OPENWEATHER_API_KEY=your_openweather_api_key_here

# OpenRouter API –∫–ª—é—á –¥–ª—è GPT
OPEN_ROUTER_API_KEY=your_openrouter_api_key_here

# URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
LOCAL_REDIS_URL=redis://redis:6379/0  # –¥–ª—è Docker
# LOCAL_REDIS_URL=redis://localhost:6379/0  # –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
```

## üì° API Endpoints

### üèôÔ∏è –ì–æ—Ä–æ–¥–∞

#### –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞
```http
GET /api/v1/city/{city_name}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X GET "http://localhost:8000/api/v1/city/Moscow"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
[
  {
    "name": "Moscow",
    "lat": 55.7522,
    "lon": 37.6156,
    "country": "RU",
    "state": null
  }
]
```

### üå°Ô∏è –ü–æ–≥–æ–¥–∞

#### –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É
```http
POST /api/v1/weather/
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "lat": 55.7522,
  "lon": 37.6156
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "coord": {
    "lon": 37.6156,
    "lat": 55.7522
  },
  "weather": [
    {
      "id": 800,
      "main": "Clear",
      "description": "clear sky",
      "icon": "01d"
    }
  ],
  "main": {
    "temp": 273.15,
    "feels_like": 269.15,
    "temp_min": 271.15,
    "temp_max": 275.15,
    "pressure": 1013,
    "humidity": 65
  },
  "visibility": 10000,
  "wind": {
    "speed": 3.5,
    "deg": 180
  },
  "clouds": {
    "all": 0
  },
  "name": "Moscow"
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –ò–ò —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```http
POST /api/v1/weather/recomendation
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –û–±—ä–µ–∫—Ç WeatherModel (–ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "content": "üå§Ô∏è **–ê–Ω–∞–ª–∏–∑ —É—Å–ª–æ–≤–∏–π**: –û—Ç–ª–∏—á–Ω–∞—è —è—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞...",
  "reasoning": "–ê–Ω–∞–ª–∏–∑ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç..."
}
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
weather_api/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ endpoints/
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ city.py          # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–æ—Ä–æ–¥–∞–º–∏
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ weather.py       # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–≥–æ–¥–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ html/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ root_html.py        # HTML –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ city.py                 # Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gpt.py                  # –ú–æ–¥–µ–ª–∏ –¥–ª—è –ò–ò –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weather.py              # –ú–æ–¥–µ–ª–∏ –¥–ª—è –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ gpt_service.py          # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ò–ò
‚îÇ       ‚îî‚îÄ‚îÄ open_weather_map_service.py  # –°–µ—Ä–≤–∏—Å OpenWeatherMap
‚îú‚îÄ‚îÄ docker-compose.yml              # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                      # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ main.py                         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt                # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ .env.example                    # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ API:

- **–î–∞–Ω–Ω—ã–µ –æ –≥–æ—Ä–æ–¥–∞—Ö**: –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 30 –º–∏–Ω—É—Ç (1800 —Å–µ–∫—É–Ω–¥)
- **–ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 30 –º–∏–Ω—É—Ç (1800 —Å–µ–∫—É–Ω–¥)
- **–ò–ò —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 1 –º–∏–Ω—É—Ç—É (60 —Å–µ–∫—É–Ω–¥)

## üê≥ Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
```bash
docker build -t weather-api .
```

### –ó–∞–ø—É—Å–∫ —Å Docker Compose
```bash
docker-compose up -d
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
docker-compose down
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose logs -f app

# –¢–æ–ª—å–∫–æ Redis
docker-compose logs -f redis
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker-compose ps
```

## üë§ –ê–≤—Ç–æ—Ä

**F1TU3S17**

- GitHub: [@F1TU3S17](https://github.com/F1TU3S17)

‚≠ê –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω!
